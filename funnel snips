-- uses the case to only count one group. In this case it is choosing only the control group

select modal_text,
count ( 
distinct case
when ab_group = 'control' then user_id
end) as 'control_clicks'
from onboarding_modals
group by 1
order by 1;

--Adding in the variant group
select modal_text,
count ( 
distinct case
when ab_group = 'control' then user_id
end) as 'control_clicks',
count(distinct case
     when ab_group = 'variant' then user_id
     end) as 'variant_clicks'
from onboarding_modals
group by 1
order by 1;


--Using three seperate tables to create a funnel
 select * from
 browse as 'b'
 left join checkout as 'c'
 on c.user_id = b.user_id 
 left join purchase as 'p'
on p.user_id = c.user_id
limit 50;
